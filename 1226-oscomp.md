## 平台的兼容性问题

K210移植
QEMU和K210平台的区别
```
系统启动上：在QEMU平台上需要通过适当的参数启动QEMU；K210平台上需要先烧写SD卡，再将内核镜像烧写到板子的RAM中，最后打开串口中断

MMIO（Memory mapping I/O）：QEMU平台上只需要映射串口和Virtio0;K210上需要映射一系列板载设备，如uarths(高速通用异步收发传输器),sysctl(动态修改内核运行时的参数),spi(串行外设接口)等。

K210平台不支持S态外部中断，需要将中断服务程序的地址传给RustSBI的拓展调用进行转发
```

## SBI
- 作用

用于引导启动操作系统的一类软件工具

为操作系统提供一系列的接口，获取和操作硬件的相关信息

- 功能

在硬件运行时处理系列的中断和异常

提供硬件环境接口

引导启动模块

兼容模块：只需实现对SBI的更新，就可以新版本标准的操作系统

## RustSBI 

文档手册：https://docs.rs/rustsbi/0.1.0/rustsbi/

RustSBI提供了很多平台的实现，如QEMU，K210等芯片的实现，可以直接安装

后续可以做的东西（增加一些功能实现)
```
实现trait（相当于对外提供的接口，每个功能模块对应一个trait),使用函数注册到RustSBI中，在ecall模块调用想要实现的功能

ecall实现模块：实现各种功能

适配平台
```

## 特权级的比较
- x86

2bit描述，原则上存在4个特权级，实际使用中一般只用到用户态，内核态。

- RISC-V

2bit描述，目前使用的一般为三种，特权级机器模式(M模式)，监管者模式(S模式)，用户模式（U模式)

S 和 U模式分别对应x86内核态和用户态，M模式则是在硬件管理的时候使用

类似的，在内存寻址，特权级切换，控制寄存器也存在着较大的区别。